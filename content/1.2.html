<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>我们的第一个插件 | Acetone</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="以较快的方式了解 Minecraft 服务端插件开发">
    
    <link rel="preload" href="/assets/css/0.styles.fb41c43f.css" as="style"><link rel="preload" href="/assets/js/app.38d29a6c.js" as="script"><link rel="preload" href="/assets/js/2.ccae3753.js" as="script"><link rel="preload" href="/assets/js/3.df5561e6.js" as="script"><link rel="preload" href="/assets/js/11.5b31e0a0.js" as="script"><link rel="prefetch" href="/assets/js/10.abbb295a.js"><link rel="prefetch" href="/assets/js/4.2f239b95.js"><link rel="prefetch" href="/assets/js/5.c44017b2.js"><link rel="prefetch" href="/assets/js/6.0bf1cba3.js"><link rel="prefetch" href="/assets/js/7.9f6e63f8.js"><link rel="prefetch" href="/assets/js/8.b38bb97e.js"><link rel="prefetch" href="/assets/js/9.c94b37f7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fb41c43f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Acetone</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  关于
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>入门</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/content/1.1.html" class="sidebar-link">1.1 插件的概念</a></li><li><a href="/content/1.2.html" aria-current="page" class="active sidebar-link">1.2 我们的第一个插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/content/1.2.html#主类" class="sidebar-link">主类</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="我们的第一个插件"><a href="#我们的第一个插件" class="header-anchor">#</a> 我们的第一个插件</h1> <p>在 1.1 中我们了解了我们在编写插件时所要知道的一些基本概念和思想，现在，让我们正式展开插件的编写。这部分内容与 Java 本身紧密联系，对于一些特殊的概念将会加粗，然后在文中以插入块的形式具体讲解。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>为了后文的叙述清楚，我们在这里约定：</p> <ul><li>我们的插件名称叫做 <code>MyPlugin</code></li> <li>我们的插件包名为 <code>com.example.myPlugin</code>，因此我们的<strong>主类</strong>所在位置应当是 <code>/src/main/java/com/example/myPlugin</code></li> <li>我们的所有操作发生在 <code>/src/main/java/com/example/myPlugin</code> 内，并将此地址简记为 <code>@</code> <ul><li>例如，<code>@/MyPlugin.java</code> 则代表 <code>/src/main/java/com/example/myPlugin/MyPlugin.java</code></li></ul></li> <li>我们的插件使用 Java 11 开发</li></ul> <p>除非声明，否则均按照此处所列信息看待。</p></div> <h2 id="主类"><a href="#主类" class="header-anchor">#</a> 主类</h2> <p><strong>主类</strong>是插件的起点。你也许听说过 C++ 里的 <code>int main()</code> 吧？那也是一个主类。主类可以认定为是整个程序的入口。那么既然它是主类，就必定有和其它「普通的类」有区别的地方——插件的主类继承了 <code>JavaPlugin</code> 这个接口（此处的接口为 Java 内部概念，与前文叙述的不一致）。</p> <p>我们创建 <code>@/Main.java</code>，那么它的包名表达就是 <code>com.example.myPlugin.Main</code>，这就是本项目的主类在项目里的绝对表达，可以用于 <code>plugin.yml</code> 内对主类的设置。一个主类通常具有以下基本结构。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// @/Main.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>myPlugin</span><span class="token punctuation">;</span> <span class="token comment">// 这里指定了当前文件所在的包，根据文件所在的位置会有所变化。</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>bukkit<span class="token punctuation">.</span></span><span class="token class-name">Bukkit</span><span class="token punctuation">;</span> <span class="token comment">// 引入</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>bukkit<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>java<span class="token punctuation">.</span></span><span class="token class-name">JavaPlugin</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token keyword">extends</span> <span class="token class-name">JavaPlugin</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onEnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">saveDefaultConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;MyPlugin is enabled.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDisable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;MyPlugin is disabled.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><strong>Java 语言讲堂 #1</strong></p> <p>从这里开始，每相隔一两小节将会出现这样一个帮助你理解 Java 语言本身的小块，你可以选择性地阅读。内容不保证权威性，如需学习，请自行寻找专业教材，同时欢迎纠正。</p> <ul><li><code>package &lt;包名&gt;</code> 表达了当前文件所在的包，其与路径有关系。由于我们的 <code>Main.java</code> 放置在 <code>@</code> 下面，也就是 <code>/src/main/java</code><strong><code>/com/example/myPlugin</code></strong> 这个目录下，所以包名写作 <code>com.example.myPlugin</code>。
<ul><li>想一想：如果我将 <code>Main.java</code> 放置在 <code>@/Utils</code> 这个文件夹下面，包名应该写作什么？类比即可得出答案：<code>com.example.myPlugin.Utils</code>。<strong>包名写错也是错。</strong></li></ul></li> <li><code>import &lt;包名&gt;</code> 导入了相应包下的类、接口等元素。例如，<code>org.bukkit</code> 是 <code>Bukkit</code> 这个类的包名，如果我们要导入 <code>Bukkit</code>，我们就可以用 <code>org.bukkit.Bukkit</code> 来代表它，然后 <code>import</code> 它即可使用。</li> <li><code>public final class &lt;类名&gt;</code> 声明了一个终极公共类（其实不应该翻译成中文的😅）。其中 <code>public</code> 代表是「可以被外界访问的」，除此之外还有 <code>protected</code> 和 <code>private</code> 两种。主类只能为 <code>public</code>。而 <code>final</code> 则表示「最终的」，代表当前类不能被<strong>继承</strong>。实际上，如果没有相关需求，<code>final</code> 是否加上是没有影响的。我们一般把用这类形容词关键字 <code>public</code>、<code>final</code> 加上一个名词关键字例如 <code>class</code> 的行为称为<strong>修饰</strong>。例如我们可以说，这个类是被 <code>public final</code> 修饰的。不是什么高级概念，只是一种叫法。</li> <li><code>extends &lt;类/接口/...&gt;</code> 继承指定的对象。这是面向对象编程的特色，具体的含义不在这里详细讲解。但你可以尝试从字面意义上理解，「继承」即代表享有被继承对象所具有的项目。而上面的 <code>final</code> 关键字可以防止某个对象被继承。</li> <li><code>@Override</code> 是一个 Java Annotation（注解），除此之外还有 <code>@Deprecated</code> 等。它们相当于是可以影响编译行为的「小工具」。Override 单词本意是「覆盖」，在这里的意思是「覆盖父类的相关方法」。因为 <code>Main</code> 这个类继承了 <code>JavaPlugin</code>，加上 <code>@Override</code> 代表着在 <code>Main</code> 里面写的这个方法，<code>JavaPlugin</code> 里面也有同名的方法。如果父类中不存在被 <code>@Override</code> 标注的方法，编译器将报错。</li> <li><code>void</code> 是一种数据类型，它代表「无返回值」。Java 中用数据类型来表达一个函数，它表示这个函数的返回值类型。对于 <code>void</code> 类函数来说，它们只负责「执行操作」而不返回任何值。</li></ul> <p>ps: 我们一般将放置在对象里的函数称为这个对象的<strong>方法（method）</strong>。</p></div> <p>一个标准的插件，应当拥有一个继承了 <code>JavaPlugin</code> 的主类，并且这个主类里有带有 <code>@Override</code> 注解的两个方法：<code>void onEnable</code> 和 <code>void onDisable</code>。其中 <code>onEnable</code> 这个函数在插件被启用的时候会被调用，而 <code>onDisable</code> 则会在插件被禁用的时候被调用。如果一个插件本身没有问题，那么服务端在启动的时候就会自动启用这个插件，于是 <code>onEnable</code> 也可以理解为在服务器启动的时候被调用。</p> <p>那么现在我们该如何写一个 Hello World 呢？其实上面的代码已经实现了这一点。根据上一段的解释，该插件在服务器启动的时候，会调用服务器的 Logger 输出一句 <code>MyPlugin is enabled.</code>；在服务器关闭的时候，会调用服务器的 Logger 输出一句 <code>MyPlugin is disabled.</code>。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如果插件内部出现错误，服务端会强行禁用它，并显示出报错。此时，<code>onDisable</code> 也会被调用。</p></div> <p>具体的表现，大概是这样的：</p> <div class="language-log extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-log"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> <span class="token property">Preparing spawn area:</span> <span class="token number">0</span><span class="token operator">%</span>
<span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> <span class="token property">Time elapsed:</span> <span class="token number">3849</span> ms
<span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>MyPlugin<span class="token punctuation">]</span> Enabling MyPlugin <span class="token number">v1.0</span><span class="token operator">-</span>SNAPSHOT
<span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>MyPlugin<span class="token punctuation">]</span> MyPlugin is enabled<span class="token punctuation">.</span>      <span class="token operator">&lt;</span><span class="token operator">-</span><span class="token operator">-</span> 这里就是你的 Hello World<span class="token operator">!</span>
<span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> Running delayed init tasks
<span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> Done <span class="token operator">(</span><span class="token number">8.970s</span><span class="token operator">)</span><span class="token operator">!</span> For help<span class="token punctuation">,</span> type <span class="token string">&quot;help&quot;</span>
<span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span> Timings Reset
</code></pre></div><p>我们 Hello World 算是写出来了，可是插件开发的思路呢？其实已经很显然了。主类作为整个插件的入口，由服务端主动调用，自然是要重点看待的。我们一般在主类里面做的事情有如下几种</p> <ul><li>一些初始化的工作
<ul><li>配置文件</li> <li>需要用到的动态类</li> <li>与数据库的连接</li></ul></li> <li>显示一个「被启用」的信息</li> <li>其它工作</li></ul> <p>也许你会想：这不全是在初始化吗？该怎样实现插件的内容呢？别着急，在后面我们介绍了一些基本功能以后，自然就会有思路了。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/content/1.1.html" class="prev">
        1.1 插件的概念
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.38d29a6c.js" defer></script><script src="/assets/js/2.ccae3753.js" defer></script><script src="/assets/js/3.df5561e6.js" defer></script><script src="/assets/js/11.5b31e0a0.js" defer></script>
  </body>
</html>
